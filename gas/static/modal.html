<!doctype html>
<html lang="en">
  <head>
    <link
      rel="stylesheet"
      href="https://ssl.gstatic.com/docs/script/css/add-ons1.css"
    />
    <style>
      :root {
        --ss-bg-color: #ffffff;
        --ss-font-placeholder-color: #8d8d8d;
        --ss-disabled-color: #dcdee2;
        --ss-border-color: #dcdee2;
        --ss-highlight-color: #fffb8c;
        --ss-success-color: #29691d;
        --ss-error-color: #dd4b39;
        --ss-main-height: 30px;
        --ss-content-height: 300px;
        --ss-spacing-l: 7px;
        --ss-spacing-m: 5px;
        --ss-spacing-s: 3px;
        --ss-animation-timing: 0s;
        --ss-border-radius: 2px;
        --ss-font-color: #333;
        --ss-primary-color: #3079ed;
      }
      @keyframes ss-valueIn {
        0% {
          transform: scale(0);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      @keyframes ss-valueOut {
        0% {
          transform: scale(1);
          opacity: 1;
        }
        100% {
          transform: scale(0);
          opacity: 0;
        }
      }
      .ss-hide {
        display: none !important;
      }
      .ss-main {
        display: flex;
        flex-direction: row;
        position: relative;
        user-select: none;
        color: var(--ss-font-color);
        min-height: var(--ss-main-height);
        width: 100%;
        padding: var(--ss-spacing-s);
        cursor: pointer;
        border: 1px solid var(--ss-border-color);
        border-radius: var(--ss-border-radius);
        background-color: var(--ss-bg-color);
        outline: 0;
        box-sizing: border-box;
        transition: background-color var(--ss-animation-timing);
        overflow: hidden;
      }
      .ss-main.ss-disabled {
        background-color: var(--ss-disabled-color);
        cursor: not-allowed;
      }
      .ss-main.ss-disabled .ss-values .ss-disabled {
        color: var(--ss-font-color);
      }
      .ss-main.ss-disabled .ss-values .ss-value .ss-value-delete {
        cursor: not-allowed;
      }
      .ss-main.ss-open-above {
        border-top-left-radius: 0px;
        border-top-right-radius: 0px;
      }
      .ss-main.ss-open-below {
        border-bottom-left-radius: 0px;
        border-bottom-right-radius: 0px;
      }
      .ss-main .ss-values {
        display: inline-flex;
        flex-wrap: wrap;
        gap: var(--ss-spacing-m);
        flex: 1 1 100%;
      }
      .ss-main .ss-values .ss-placeholder {
        display: flex;
        padding: var(--ss-spacing-s) var(--ss-spacing-m) var(--ss-spacing-s)
          var(--ss-spacing-m);
        margin: auto 0px auto 0px;
        line-height: 1em;
        align-items: center;
        width: 100%;
        color: var(--ss-font-placeholder-color);
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
      }
      .ss-main .ss-values .ss-max {
        display: flex;
        user-select: none;
        align-items: center;
        width: fit-content;
        font-size: 13px;
        color: var(--ss-bg-color);
        line-height: 1;
        padding: var(--ss-spacing-s) var(--ss-spacing-m);
        background: -webkit-linear-gradient(top, #4d90fe, #4787ed);
        background: linear-gradient(top, #4d90fe, #4787ed);
        border: 1px solid var(--ss-primary-color);
        border-radius: var(--ss-border-radius);
      }
      .ss-main .ss-values .ss-single {
        display: flex;
        margin: auto 0px auto var(--ss-spacing-s);
      }
      .ss-main .ss-values .ss-value {
        display: flex;
        user-select: none;
        align-items: center;
        width: fit-content;
        background: -webkit-linear-gradient(top, #4d90fe, #4787ed);
        background: linear-gradient(top, #4d90fe, #4787ed);
        border: 1px solid var(--ss-primary-color);
        border-radius: var(--ss-border-radius);
        animation-name: ss-valueIn;
        animation-duration: var(--ss-animation-timing);
        animation-timing-function: ease-out;
        animation-fill-mode: both;
      }
      .ss-main .ss-values .ss-value.ss-value-out {
        animation-name: ss-valueOut;
        animation-duration: var(--ss-animation-timing);
        animation-timing-function: ease-out;
      }
      .ss-main .ss-values .ss-value .ss-value-text {
        font-size: 12px;
        color: var(--ss-bg-color);
        line-height: 1;
        padding: var(--ss-spacing-s) var(--ss-spacing-m);
      }
      .ss-main .ss-values .ss-value .ss-value-delete {
        display: flex;
        align-items: center;
        height: var(--ss-spacing-l);
        width: var(--ss-spacing-l);
        padding: var(--ss-spacing-s) var(--ss-spacing-m);
        cursor: pointer;
        border-left: solid 1px var(--ss-bg-color);
        box-sizing: content-box;
      }
      .ss-main .ss-values .ss-value .ss-value-delete svg {
        height: var(--ss-spacing-l);
        width: var(--ss-spacing-l);
      }
      .ss-main .ss-values .ss-value .ss-value-delete svg path {
        fill: none;
        stroke: var(--ss-bg-color);
        stroke-width: 18;
        stroke-linecap: round;
        stroke-linejoin: round;
      }
      .ss-main .ss-deselect {
        display: flex;
        align-self: center;
        justify-content: flex-end;
        flex: 0 1 auto;
        width: 8px;
        height: 8px;
        margin: 0 var(--ss-spacing-m) 0 var(--ss-spacing-m);
      }
      .ss-main .ss-deselect svg {
        width: 8px;
        height: 8px;
      }
      .ss-main .ss-deselect svg path {
        fill: none;
        stroke: var(--ss-font-color);
        stroke-width: 20;
        stroke-linecap: round;
        stroke-linejoin: round;
      }
      .ss-main .ss-arrow {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        flex: 0 1 auto;
        width: 12px;
        height: 12px;
        margin: auto var(--ss-spacing-m) auto var(--ss-spacing-m);
      }
      .ss-main .ss-arrow path {
        fill: none;
        stroke: var(--ss-font-color);
        stroke-width: 18;
        stroke-linecap: round;
        stroke-linejoin: round;
        transition-timing-function: ease-out;
        transition: var(--ss-animation-timing);
      }
      .ss-content {
        position: absolute;
        display: flex;
        height: auto;
        flex-direction: column;
        width: auto;
        max-height: var(--ss-content-height);
        box-sizing: border-box;
        border: solid 1px var(--ss-border-color);
        background-color: var(--ss-bg-color);
        transition:
          transform var(--ss-animation-timing),
          opacity var(--ss-animation-timing);
        opacity: 0;
        transform: scaleY(0);
        transform-origin: center top;
        overflow: hidden;
        z-index: 10000;
      }
      .ss-content.ss-relative {
        position: relative;
        height: 100%;
      }
      .ss-content.ss-open-above {
        flex-direction: column-reverse;
        opacity: 1;
        transform: scaleY(1);
        transform-origin: center bottom;
        border-top-left-radius: var(--ss-border-radius);
        border-top-right-radius: var(--ss-border-radius);
      }
      .ss-content.ss-open-below {
        opacity: 1;
        transform: scaleY(1);
        transform-origin: center top;
        border-bottom-left-radius: var(--ss-border-radius);
        border-bottom-right-radius: var(--ss-border-radius);
      }
      .ss-content .ss-search {
        flex: 0 1 auto;
        display: flex;
        flex-direction: row;
        padding: var(--ss-spacing-l) var(--ss-spacing-l) var(--ss-spacing-m)
          var(--ss-spacing-l);
      }
      .ss-content .ss-search input {
        display: inline-flex;
        font-size: inherit;
        line-height: inherit;
        flex: 1 1 auto;
        width: 100%;
        min-width: 0px;
        padding: var(--ss-spacing-m) var(--ss-spacing-l);
        margin: 0;
        border: 1px solid var(--ss-border-color);
        border-radius: var(--ss-border-radius);
        background-color: var(--ss-bg-color);
        outline: 0;
        text-align: left;
        box-sizing: border-box;
      }
      .ss-content .ss-search input::placeholder {
        color: var(--ss-font-placeholder-color);
        vertical-align: middle;
      }

      .ss-content .ss-search .ss-addable {
        display: inline-flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        flex: 0 0 auto;
        height: auto;
        margin: 0 0 0 var(--ss-spacing-m);
        border: 1px solid var(--ss-border-color);
        border-radius: var(--ss-border-radius);
      }
      .ss-content .ss-search .ss-addable svg {
        display: flex;
        align-items: center;
        justify-content: flex-end;
        flex: 0 1 auto;
        width: 12px;
        height: 12px;
        margin: auto var(--ss-spacing-m) auto var(--ss-spacing-m);
      }
      .ss-content .ss-search .ss-addable svg path {
        fill: none;
        stroke: var(--ss-font-color);
        stroke-width: 18;
        stroke-linecap: round;
        stroke-linejoin: round;
      }
      .ss-content .ss-list {
        flex: 1 1 auto;
        height: auto;
        overflow-x: hidden;
        overflow-y: auto;
      }
      .ss-content .ss-list .ss-error {
        color: var(--ss-error-color);
        padding: var(--ss-spacing-l);
      }
      .ss-content .ss-list .ss-searching {
        color: var(--ss-font-color);
        padding: var(--ss-spacing-l);
      }
      .ss-content .ss-list .ss-optgroup.ss-close .ss-option {
        display: none !important;
      }
      .ss-content .ss-list .ss-optgroup .ss-optgroup-label {
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        padding: var(--ss-spacing-m) var(--ss-spacing-l) var(--ss-spacing-m)
          var(--ss-spacing-l);
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-label-text {
        flex: 1 1 auto;
        font-weight: bold;
        color: var(--ss-font-color);
      }
      .ss-content .ss-list .ss-optgroup .ss-optgroup-label:has(.ss-arrow) {
        cursor: pointer;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions {
        flex: 0 1 auto;
        display: flex;
        flex-direction: row;
        align-items: center;
        justify-content: center;
        gap: var(--ss-spacing-m);
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall {
        flex: 0 0 auto;
        display: flex;
        flex-direction: row;
        cursor: pointer;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall:hover {
        opacity: 0.5;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall.ss-selected
        svg
        path {
        stroke: var(--ss-error-color);
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall
        span {
        flex: 0 1 auto;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 60%;
        text-align: center;
        padding: 0 var(--ss-spacing-s) 0 0;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall
        svg {
        flex: 0 1 auto;
        width: 13px;
        height: 13px;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall
        svg
        path {
        fill: none;
        stroke: var(--ss-success-color);
        stroke-linecap: round;
        stroke-linejoin: round;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall
        svg:first-child {
        stroke-width: 5;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-selectall
        svg:last-child {
        stroke-width: 11;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-closable {
        flex: 0 1 auto;
        display: flex;
        flex-direction: row;
        cursor: pointer;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-closable
        .ss-arrow {
        flex: 1 1 auto;
        width: 10px;
        height: 10px;
      }
      .ss-content
        .ss-list
        .ss-optgroup
        .ss-optgroup-label
        .ss-optgroup-actions
        .ss-closable
        .ss-arrow
        path {
        fill: none;
        stroke: var(--ss-font-color);
        stroke-width: 18;
        stroke-linecap: round;
        stroke-linejoin: round;
        transition-timing-function: ease-out;
        transition: var(--ss-animation-timing);
      }
      .ss-content .ss-list .ss-optgroup .ss-option {
        padding: var(--ss-spacing-s) var(--ss-spacing-s) var(--ss-spacing-s)
          calc(var(--ss-spacing-l) * 3);
      }
      .ss-content .ss-list .ss-option {
        display: flex;
        padding: var(--ss-spacing-m) var(--ss-spacing-l) var(--ss-spacing-m)
          var(--ss-spacing-l);
        color: var(--ss-font-color);
        cursor: pointer;
        user-select: none;
      }
      .ss-content .ss-list .ss-option:hover {
        color: var(--ss-bg-color);
        background-color: var(--ss-primary-color);
      }
      .ss-content .ss-list .ss-option.ss-highlighted,
      .ss-content .ss-list .ss-option:not(.ss-disabled).ss-selected {
        color: var(--ss-bg-color);
        background-color: var(--ss-primary-color);
      }
      .ss-content .ss-list .ss-option.ss-disabled {
        cursor: not-allowed;
        background-color: var(--ss-disabled-color);
      }
      .ss-content .ss-list .ss-option.ss-disabled:hover {
        color: var(--ss-font-color);
      }
      .ss-content .ss-list .ss-option .ss-search-highlight {
        background-color: var(--ss-highlight-color);
      } /*# sourceMappingURL=slimselect.css.map */

      .form-group > input {
        height: 29px;
      }

      input:not(:empty):invalid + .error {
        display: block;
      }

      input:valid + .error {
        display: none;
      }

      input + .error {
        position: absolute;
      }

      .row {
        display: flex;
        align-items: flex-end;
      }

      .row + .row {
        margin-top: 20px;
      }

      .d-none {
        display: none;
      }
      .ma0 {
        margin: 0;
      }
      .ma1 {
        margin: 0.25rem;
      }
      .ma2 {
        margin: 0.5rem;
      }
      .ma3 {
        margin: 1rem;
      }
      .ma4 {
        margin: 2rem;
      }
      .ma5 {
        margin: 4rem;
      }
      .ma6 {
        margin: 8rem;
      }
      .ma7 {
        margin: 16rem;
      }
      .ml0 {
        margin-left: 0;
      }
      .ml1 {
        margin-left: 0.25rem;
      }
      .ml2 {
        margin-left: 0.5rem;
      }
      .ml3 {
        margin-left: 1rem;
      }
      .ml4 {
        margin-left: 2rem;
      }
      .ml5 {
        margin-left: 4rem;
      }
      .ml6 {
        margin-left: 8rem;
      }
      .ml7 {
        margin-left: 16rem;
      }
      .mr0 {
        margin-right: 0;
      }
      .mr1 {
        margin-right: 0.25rem;
      }
      .mr2 {
        margin-right: 0.5rem;
      }
      .mr3 {
        margin-right: 1rem;
      }
      .mr4 {
        margin-right: 2rem;
      }
      .mr5 {
        margin-right: 4rem;
      }
      .mr6 {
        margin-right: 8rem;
      }
      .mr7 {
        margin-right: 16rem;
      }
      .mb0 {
        margin-bottom: 0;
      }
      .mb1 {
        margin-bottom: 0.25rem;
      }
      .mb2 {
        margin-bottom: 0.5rem;
      }
      .mb3 {
        margin-bottom: 1rem;
      }
      .mb4 {
        margin-bottom: 2rem;
      }
      .mb5 {
        margin-bottom: 4rem;
      }
      .mb6 {
        margin-bottom: 8rem;
      }
      .mb7 {
        margin-bottom: 16rem;
      }
      .mt0 {
        margin-top: 0;
      }
      .mt1 {
        margin-top: 0.25rem;
      }
      .mt2 {
        margin-top: 0.5rem;
      }
      .mt3 {
        margin-top: 1rem;
      }
      .mt4 {
        margin-top: 2rem;
      }
      .mt5 {
        margin-top: 4rem;
      }
      .mt6 {
        margin-top: 8rem;
      }
      .mt7 {
        margin-top: 16rem;
      }
      .mv0 {
        margin-top: 0;
        margin-bottom: 0;
      }
      .mv1 {
        margin-top: 0.25rem;
        margin-bottom: 0.25rem;
      }
      .mv2 {
        margin-top: 0.5rem;
        margin-bottom: 0.5rem;
      }
      .mv3 {
        margin-top: 1rem;
        margin-bottom: 1rem;
      }
      .mv4 {
        margin-top: 2rem;
        margin-bottom: 2rem;
      }
      .mv5 {
        margin-top: 4rem;
        margin-bottom: 4rem;
      }
      .mv6 {
        margin-top: 8rem;
        margin-bottom: 8rem;
      }
      .mv7 {
        margin-top: 16rem;
        margin-bottom: 16rem;
      }
      .mh0 {
        margin-left: 0;
        margin-right: 0;
      }
      .mh1 {
        margin-left: 0.25rem;
        margin-right: 0.25rem;
      }
      .mh2 {
        margin-left: 0.5rem;
        margin-right: 0.5rem;
      }
      .mh3 {
        margin-left: 1rem;
        margin-right: 1rem;
      }
      .mh4 {
        margin-left: 2rem;
        margin-right: 2rem;
      }
      .mh5 {
        margin-left: 4rem;
        margin-right: 4rem;
      }
      .mh6 {
        margin-left: 8rem;
        margin-right: 8rem;
      }
      .mh7 {
        margin-left: 16rem;
        margin-right: 16rem;
      }
      .na1 {
        margin: -0.25rem;
      }
      .na2 {
        margin: -0.5rem;
      }
      .na3 {
        margin: -1rem;
      }
      .na4 {
        margin: -2rem;
      }
      .na5 {
        margin: -4rem;
      }
      .na6 {
        margin: -8rem;
      }
      .na7 {
        margin: -16rem;
      }
      .nl1 {
        margin-left: -0.25rem;
      }
      .nl2 {
        margin-left: -0.5rem;
      }
      .nl3 {
        margin-left: -1rem;
      }
      .nl4 {
        margin-left: -2rem;
      }
      .nl5 {
        margin-left: -4rem;
      }
      .nl6 {
        margin-left: -8rem;
      }
      .nl7 {
        margin-left: -16rem;
      }
      .nr1 {
        margin-right: -0.25rem;
      }
      .nr2 {
        margin-right: -0.5rem;
      }
      .nr3 {
        margin-right: -1rem;
      }
      .nr4 {
        margin-right: -2rem;
      }
      .nr5 {
        margin-right: -4rem;
      }
      .nr6 {
        margin-right: -8rem;
      }
      .nr7 {
        margin-right: -16rem;
      }
      .nb1 {
        margin-bottom: -0.25rem;
      }
      .nb2 {
        margin-bottom: -0.5rem;
      }
      .nb3 {
        margin-bottom: -1rem;
      }
      .nb4 {
        margin-bottom: -2rem;
      }
      .nb5 {
        margin-bottom: -4rem;
      }
      .nb6 {
        margin-bottom: -8rem;
      }
      .nb7 {
        margin-bottom: -16rem;
      }
      .nt1 {
        margin-top: -0.25rem;
      }
      .nt2 {
        margin-top: -0.5rem;
      }
      .nt3 {
        margin-top: -1rem;
      }
      .nt4 {
        margin-top: -2rem;
      }
      .nt5 {
        margin-top: -4rem;
      }
      .nt6 {
        margin-top: -8rem;
      }
      .nt7 {
        margin-top: -16rem;
      }

      .mw-100 {
        max-width: 100%;
      }
      .mw1 {
        max-width: 1rem;
      }
      .mw2 {
        max-width: 2rem;
      }
      .mw3 {
        max-width: 4rem;
      }
      .mw4 {
        max-width: 8rem;
      }
      .mw5 {
        max-width: 16rem;
      }
      .mw6 {
        max-width: 32rem;
      }
      .mw7 {
        max-width: 48rem;
      }
      .mw8 {
        max-width: 64rem;
      }
      .mw9 {
        max-width: 96rem;
      }
      .mw-none {
        max-width: none;
      }
      .w1 {
        width: 1rem;
      }
      .w2 {
        width: 2rem;
      }
      .w3 {
        width: 4rem;
      }
      .w4 {
        width: 8rem;
      }
      .w5 {
        width: 16rem;
      }
      .w-10 {
        width: 10%;
      }
      .w-20 {
        width: 20%;
      }
      .w-25 {
        width: 25%;
      }
      .w-30 {
        width: 30%;
      }
      .w-33 {
        width: 33%;
      }
      .w-34 {
        width: 34%;
      }
      .w-40 {
        width: 40%;
      }
      .w-50 {
        width: 50%;
      }
      .w-60 {
        width: 60%;
      }
      .w-70 {
        width: 70%;
      }
      .w-75 {
        width: 75%;
      }
      .w-80 {
        width: 80%;
      }
      .w-90 {
        width: 90%;
      }
      .w-100 {
        width: 100%;
      }
      .w-third {
        width: 33.33333%;
      }
      .w-two-thirds {
        width: 66.66667%;
      }
      .w-auto {
        width: auto;
      }
      .center {
        margin-left: auto;
      }
      .center,
      .mr-auto {
        margin-right: auto;
      }
      .ml-auto {
        margin-left: auto;
      }
    </style>
    <base target="_top" />
    <script>
      !(function (e, t) {
        'object' == typeof exports && 'undefined' != typeof module
          ? (module.exports = t())
          : 'function' == typeof define && define.amd
          ? define(t)
          : ((e =
              'undefined' != typeof globalThis
                ? globalThis
                : e || self).SlimSelect = t());
      })(this, function () {
        'use strict';
        function e() {
          return Math.random().toString(36).substring(2, 10);
        }
        function t(e, t = 50, s = !1) {
          let i;
          return function (...n) {
            const a = self,
              l = s && !i;
            clearTimeout(i),
              (i = setTimeout(() => {
                (i = null), s || e.apply(a, n);
              }, t)),
              l && e.apply(a, n);
          };
        }
        function s(e, t) {
          return JSON.stringify(e) === JSON.stringify(t);
        }
        class i {
          constructor(t) {
            (this.id = ''),
              (this.style = ''),
              (this.class = []),
              (this.isMultiple = !1),
              (this.isOpen = !1),
              (this.isFullOpen = !1),
              (this.intervalMove = null),
              t || (t = {}),
              (this.id = 'ss-' + e()),
              (this.style = t.style || ''),
              (this.class = t.class || []),
              (this.disabled = void 0 !== t.disabled && t.disabled),
              (this.alwaysOpen = void 0 !== t.alwaysOpen && t.alwaysOpen),
              (this.showSearch = void 0 === t.showSearch || t.showSearch),
              (this.searchPlaceholder = t.searchPlaceholder || 'Search'),
              (this.searchText = t.searchText || 'No Results'),
              (this.searchingText = t.searchingText || 'Searching...'),
              (this.searchHighlight =
                void 0 !== t.searchHighlight && t.searchHighlight),
              (this.closeOnSelect =
                void 0 === t.closeOnSelect || t.closeOnSelect),
              (this.contentLocation = t.contentLocation || document.body),
              (this.contentPosition = t.contentPosition || 'absolute'),
              (this.openPosition = t.openPosition || 'auto'),
              (this.placeholderText =
                void 0 !== t.placeholderText
                  ? t.placeholderText
                  : 'Select Value'),
              (this.allowDeselect =
                void 0 !== t.allowDeselect && t.allowDeselect),
              (this.hideSelected = void 0 !== t.hideSelected && t.hideSelected),
              (this.showOptionTooltips =
                void 0 !== t.showOptionTooltips && t.showOptionTooltips),
              (this.minSelected = t.minSelected || 0),
              (this.maxSelected = t.maxSelected || 1e3),
              (this.timeoutDelay = t.timeoutDelay || 200),
              (this.maxValuesShown = t.maxValuesShown || 20),
              (this.maxValuesMessage =
                t.maxValuesMessage || '{number} selected');
          }
        }
        class n {
          constructor(t) {
            if (
              ((this.id = t.id && '' !== t.id ? t.id : e()),
              (this.label = t.label || ''),
              (this.selectAll = void 0 !== t.selectAll && t.selectAll),
              (this.selectAllText = t.selectAllText || 'Select All'),
              (this.closable = t.closable || 'off'),
              (this.options = []),
              t.options)
            )
              for (const e of t.options) this.options.push(new a(e));
          }
        }
        class a {
          constructor(t) {
            (this.id = t.id && '' !== t.id ? t.id : e()),
              (this.value = void 0 === t.value ? t.text : t.value),
              (this.text = t.text || ''),
              (this.html = t.html || ''),
              (this.selected = void 0 !== t.selected && t.selected),
              (this.display = void 0 === t.display || t.display),
              (this.disabled = void 0 !== t.disabled && t.disabled),
              (this.mandatory = void 0 !== t.mandatory && t.mandatory),
              (this.placeholder = void 0 !== t.placeholder && t.placeholder),
              (this.class = t.class || ''),
              (this.style = t.style || ''),
              (this.data = t.data || {});
          }
        }
        class l {
          constructor(e, t) {
            (this.selectType = 'single'),
              (this.data = []),
              (this.selectType = e),
              this.setData(t);
          }
          validateDataArray(e) {
            if (!Array.isArray(e)) return new Error('Data must be an array');
            for (let t of e) {
              if (!(t instanceof n || 'label' in t))
                return t instanceof a || 'text' in t
                  ? this.validateOption(t)
                  : new Error('Data object must be a valid optgroup or option');
              if (!('label' in t))
                return new Error('Optgroup must have a label');
              if ('options' in t && t.options)
                for (let e of t.options) return this.validateOption(e);
            }
            return null;
          }
          validateOption(e) {
            return 'text' in e ? null : new Error('Option must have a text');
          }
          partialToFullData(e) {
            let t = [];
            return (
              e.forEach((e) => {
                if (e instanceof n || 'label' in e) {
                  let s = [];
                  'options' in e &&
                    e.options &&
                    e.options.forEach((e) => {
                      s.push(new a(e));
                    }),
                    s.length > 0 && t.push(new n(e));
                }
                (e instanceof a || 'text' in e) && t.push(new a(e));
              }),
              t
            );
          }
          setData(e) {
            (this.data = this.partialToFullData(e)),
              'single' === this.selectType &&
                this.setSelectedBy('value', this.getSelected());
          }
          getData() {
            return this.filter(null, !0);
          }
          getDataOptions() {
            return this.filter(null, !1);
          }
          addOption(e) {
            this.setData(this.getData().concat(new a(e)));
          }
          setSelectedBy(e, t) {
            let s = null,
              i = !1;
            for (let l of this.data) {
              if (l instanceof n)
                for (let n of l.options)
                  s || (s = n),
                    (n.selected = !i && t.includes(n[e])),
                    n.selected && 'single' === this.selectType && (i = !0);
              l instanceof a &&
                (s || (s = l),
                (l.selected = !i && t.includes(l[e])),
                l.selected && 'single' === this.selectType && (i = !0));
            }
            'single' === this.selectType && s && !i && (s.selected = !0);
          }
          getSelected() {
            let e = this.getSelectedOptions(),
              t = [];
            return (
              e.forEach((e) => {
                t.push(e.value);
              }),
              t
            );
          }
          getSelectedOptions() {
            return this.filter((e) => e.selected, !1);
          }
          getSelectedIDs() {
            let e = this.getSelectedOptions(),
              t = [];
            return (
              e.forEach((e) => {
                t.push(e.id);
              }),
              t
            );
          }
          getOptgroupByID(e) {
            for (let t of this.data) if (t instanceof n && t.id === e) return t;
            return null;
          }
          getOptionByID(e) {
            let t = this.filter((t) => t.id === e, !1);
            return t.length ? t[0] : null;
          }
          search(e, t) {
            return '' === (e = e.trim())
              ? this.getData()
              : this.filter((s) => t(s, e), !0);
          }
          filter(e, t) {
            const s = [];
            return (
              this.data.forEach((i) => {
                if (i instanceof n) {
                  let l = [];
                  if (
                    (i.options.forEach((i) => {
                      (e && !e(i)) || (t ? l.push(new a(i)) : s.push(new a(i)));
                    }),
                    l.length > 0)
                  ) {
                    let e = new n(i);
                    (e.options = l), s.push(e);
                  }
                }
                i instanceof a && ((e && !e(i)) || s.push(new a(i)));
              }),
              s
            );
          }
          getSelectType() {
            return this.selectType;
          }
        }
        class o {
          constructor(e, t, s) {
            (this.classes = {
              main: 'ss-main',
              placeholder: 'ss-placeholder',
              values: 'ss-values',
              single: 'ss-single',
              max: 'ss-max',
              value: 'ss-value',
              valueText: 'ss-value-text',
              valueDelete: 'ss-value-delete',
              valueOut: 'ss-value-out',
              deselect: 'ss-deselect',
              deselectPath: 'M10,10 L90,90 M10,90 L90,10',
              arrow: 'ss-arrow',
              arrowClose: 'M10,30 L50,70 L90,30',
              arrowOpen: 'M10,70 L50,30 L90,70',
              content: 'ss-content',
              openAbove: 'ss-open-above',
              openBelow: 'ss-open-below',
              search: 'ss-search',
              searchHighlighter: 'ss-search-highlight',
              searching: 'ss-searching',
              addable: 'ss-addable',
              addablePath: 'M50,10 L50,90 M10,50 L90,50',
              list: 'ss-list',
              optgroup: 'ss-optgroup',
              optgroupLabel: 'ss-optgroup-label',
              optgroupLabelText: 'ss-optgroup-label-text',
              optgroupActions: 'ss-optgroup-actions',
              optgroupSelectAll: 'ss-selectall',
              optgroupSelectAllBox: 'M60,10 L10,10 L10,90 L90,90 L90,50',
              optgroupSelectAllCheck: 'M30,45 L50,70 L90,10',
              optgroupClosable: 'ss-closable',
              option: 'ss-option',
              optionDelete: 'M10,10 L90,90 M10,90 L90,10',
              highlighted: 'ss-highlighted',
              open: 'ss-open',
              close: 'ss-close',
              selected: 'ss-selected',
              error: 'ss-error',
              disabled: 'ss-disabled',
              hide: 'ss-hide',
            }),
              (this.store = t),
              (this.settings = e),
              (this.callbacks = s),
              (this.main = this.mainDiv()),
              (this.content = this.contentDiv()),
              this.updateClassStyles(),
              this.updateAriaAttributes(),
              this.settings.contentLocation.appendChild(this.content.main);
          }
          enable() {
            this.main.main.classList.remove(this.classes.disabled),
              (this.content.search.input.disabled = !1);
          }
          disable() {
            this.main.main.classList.add(this.classes.disabled),
              (this.content.search.input.disabled = !0);
          }
          open() {
            this.main.arrow.path.setAttribute('d', this.classes.arrowOpen),
              this.main.main.classList.add(
                'up' === this.settings.openPosition
                  ? this.classes.openAbove
                  : this.classes.openBelow,
              ),
              this.main.main.setAttribute('aria-expanded', 'true'),
              this.moveContent();
            const e = this.store.getSelectedOptions();
            if (e.length) {
              const t = e[e.length - 1].id,
                s = this.content.list.querySelector('[data-id="' + t + '"]');
              s && this.ensureElementInView(this.content.list, s);
            }
          }
          close() {
            this.main.main.classList.remove(this.classes.openAbove),
              this.main.main.classList.remove(this.classes.openBelow),
              this.main.main.setAttribute('aria-expanded', 'false'),
              this.content.main.classList.remove(this.classes.openAbove),
              this.content.main.classList.remove(this.classes.openBelow),
              this.main.arrow.path.setAttribute('d', this.classes.arrowClose);
          }
          updateClassStyles() {
            if (
              ((this.main.main.className = ''),
              this.main.main.removeAttribute('style'),
              (this.content.main.className = ''),
              this.content.main.removeAttribute('style'),
              this.main.main.classList.add(this.classes.main),
              this.content.main.classList.add(this.classes.content),
              '' !== this.settings.style &&
                ((this.main.main.style.cssText = this.settings.style),
                (this.content.main.style.cssText = this.settings.style)),
              this.settings.class.length)
            )
              for (const e of this.settings.class)
                '' !== e.trim() &&
                  (this.main.main.classList.add(e.trim()),
                  this.content.main.classList.add(e.trim()));
            'relative' === this.settings.contentPosition &&
              this.content.main.classList.add(
                'ss-' + this.settings.contentPosition,
              );
          }
          updateAriaAttributes() {
            (this.main.main.role = 'combobox'),
              this.main.main.setAttribute('aria-haspopup', 'listbox'),
              this.main.main.setAttribute(
                'aria-controls',
                this.content.main.id,
              ),
              this.main.main.setAttribute('aria-expanded', 'false'),
              this.content.main.setAttribute('role', 'listbox');
          }
          mainDiv() {
            var e;
            const t = document.createElement('div');
            (t.dataset.id = this.settings.id),
              (t.id = this.settings.id),
              (t.tabIndex = 0),
              (t.onkeydown = (e) => {
                switch (e.key) {
                  case 'ArrowUp':
                  case 'ArrowDown':
                    return (
                      this.callbacks.open(),
                      'ArrowDown' === e.key
                        ? this.highlight('down')
                        : this.highlight('up'),
                      !1
                    );
                  case 'Tab':
                    return this.callbacks.close(), !0;
                  case 'Enter':
                  case ' ':
                    this.callbacks.open();
                    const t = this.content.list.querySelector(
                      '.' + this.classes.highlighted,
                    );
                    return t && t.click(), !1;
                  case 'Escape':
                    return this.callbacks.close(), !1;
                }
              }),
              (t.onclick = (e) => {
                this.settings.disabled ||
                  (this.settings.isOpen
                    ? this.callbacks.close()
                    : this.callbacks.open());
              });
            const s = document.createElement('div');
            s.classList.add(this.classes.values), t.appendChild(s);
            const i = document.createElement('div');
            i.classList.add(this.classes.deselect);
            const n =
              null === (e = this.store) || void 0 === e
                ? void 0
                : e.getSelectedOptions();
            !this.settings.allowDeselect ||
            (this.settings.isMultiple && n && n.length <= 0)
              ? i.classList.add(this.classes.hide)
              : i.classList.remove(this.classes.hide),
              (i.onclick = (e) => {
                if ((e.stopPropagation(), this.settings.disabled)) return;
                let t = !0;
                const s = this.store.getSelectedOptions(),
                  i = [];
                this.callbacks.beforeChange &&
                  (t = !0 === this.callbacks.beforeChange(i, s)),
                  t &&
                    (this.settings.isMultiple
                      ? (this.callbacks.setSelected([], !1),
                        this.updateDeselectAll())
                      : this.callbacks.setSelected([''], !1),
                    this.settings.closeOnSelect && this.callbacks.close(),
                    this.callbacks.afterChange &&
                      this.callbacks.afterChange(i));
              });
            const a = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'svg',
            );
            a.setAttribute('viewBox', '0 0 100 100');
            const l = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'path',
            );
            l.setAttribute('d', this.classes.deselectPath),
              a.appendChild(l),
              i.appendChild(a),
              t.appendChild(i);
            const o = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'svg',
            );
            o.classList.add(this.classes.arrow),
              o.setAttribute('viewBox', '0 0 100 100');
            const c = document.createElementNS(
              'http://www.w3.org/2000/svg',
              'path',
            );
            return (
              c.setAttribute('d', this.classes.arrowClose),
              this.settings.alwaysOpen && o.classList.add(this.classes.hide),
              o.appendChild(c),
              t.appendChild(o),
              {
                main: t,
                values: s,
                deselect: { main: i, svg: a, path: l },
                arrow: { main: o, path: c },
              }
            );
          }
          mainFocus(e) {
            'click' !== e && this.main.main.focus({ preventScroll: !0 });
          }
          placeholder() {
            const e = this.store.filter((e) => e.placeholder, !1);
            let t = this.settings.placeholderText;
            e.length &&
              ('' !== e[0].html
                ? (t = e[0].html)
                : '' !== e[0].text && (t = e[0].text));
            const s = document.createElement('div');
            return (
              s.classList.add(this.classes.placeholder), (s.innerHTML = t), s
            );
          }
          renderValues() {
            this.settings.isMultiple
              ? this.renderMultipleValues()
              : this.renderSingleValue();
          }
          renderSingleValue() {
            const e = this.store.filter(
                (e) => e.selected && !e.placeholder,
                !1,
              ),
              t = e.length > 0 ? e[0] : null;
            if (t) {
              const e = document.createElement('div');
              e.classList.add(this.classes.single),
                t.html ? (e.innerHTML = t.html) : (e.innerText = t.text),
                (this.main.values.innerHTML = e.outerHTML);
            } else this.main.values.innerHTML = this.placeholder().outerHTML;
            this.settings.allowDeselect && e.length
              ? this.main.deselect.main.classList.remove(this.classes.hide)
              : this.main.deselect.main.classList.add(this.classes.hide);
          }
          renderMultipleValues() {
            let e = this.main.values.childNodes,
              t = this.store.filter((e) => e.selected && e.display, !1);
            if (0 === t.length)
              return void (this.main.values.innerHTML =
                this.placeholder().outerHTML);
            {
              const e = this.main.values.querySelector(
                '.' + this.classes.placeholder,
              );
              e && e.remove();
            }
            if (t.length > this.settings.maxValuesShown) {
              const e = document.createElement('div');
              return (
                e.classList.add(this.classes.max),
                (e.textContent = this.settings.maxValuesMessage.replace(
                  '{number}',
                  t.length.toString(),
                )),
                void (this.main.values.innerHTML = e.outerHTML)
              );
            }
            {
              const e = this.main.values.querySelector('.' + this.classes.max);
              e && e.remove();
            }
            let s = [];
            for (let i = 0; i < e.length; i++) {
              const n = e[i],
                a = n.getAttribute('data-id');
              if (a) {
                t.filter((e) => e.id === a, !1).length || s.push(n);
              }
            }
            for (const e of s)
              e.classList.add(this.classes.valueOut),
                setTimeout(() => {
                  this.main.values.hasChildNodes() &&
                    this.main.values.contains(e) &&
                    this.main.values.removeChild(e);
                }, 100);
            e = this.main.values.childNodes;
            for (let s = 0; s < t.length; s++) {
              let i = !0;
              for (let n = 0; n < e.length; n++)
                t[s].id === String(e[n].dataset.id) && (i = !1);
              i &&
                (0 === e.length
                  ? this.main.values.appendChild(this.multipleValue(t[s]))
                  : 0 === s
                  ? this.main.values.insertBefore(
                      this.multipleValue(t[s]),
                      e[s],
                    )
                  : e[s - 1].insertAdjacentElement(
                      'afterend',
                      this.multipleValue(t[s]),
                    ));
            }
            this.updateDeselectAll();
          }
          multipleValue(e) {
            const t = document.createElement('div');
            t.classList.add(this.classes.value), (t.dataset.id = e.id);
            const s = document.createElement('div');
            if (
              (s.classList.add(this.classes.valueText),
              (s.innerText = e.text),
              t.appendChild(s),
              !e.mandatory)
            ) {
              const s = document.createElement('div');
              s.classList.add(this.classes.valueDelete),
                (s.onclick = (t) => {
                  if (
                    (t.preventDefault(),
                    t.stopPropagation(),
                    this.settings.disabled)
                  )
                    return;
                  let s = !0;
                  const i = this.store.getSelectedOptions(),
                    l = i.filter((t) => t.selected && t.id !== e.id, !0);
                  if (
                    !(
                      this.settings.minSelected &&
                      l.length < this.settings.minSelected
                    ) &&
                    (this.callbacks.beforeChange &&
                      (s = !0 === this.callbacks.beforeChange(l, i)),
                    s)
                  ) {
                    let e = [];
                    for (const t of l) {
                      if (t instanceof n)
                        for (const s of t.options) e.push(s.value);
                      t instanceof a && e.push(t.value);
                    }
                    this.callbacks.setSelected(e, !1),
                      this.settings.closeOnSelect && this.callbacks.close(),
                      this.callbacks.afterChange &&
                        this.callbacks.afterChange(l),
                      this.updateDeselectAll();
                  }
                });
              const i = document.createElementNS(
                'http://www.w3.org/2000/svg',
                'svg',
              );
              i.setAttribute('viewBox', '0 0 100 100');
              const l = document.createElementNS(
                'http://www.w3.org/2000/svg',
                'path',
              );
              l.setAttribute('d', this.classes.optionDelete),
                i.appendChild(l),
                s.appendChild(i),
                t.appendChild(s);
            }
            return t;
          }
          contentDiv() {
            const e = document.createElement('div');
            (e.dataset.id = this.settings.id), (e.id = this.settings.id);
            const t = this.searchDiv();
            e.appendChild(t.main);
            const s = this.listDiv();
            return e.appendChild(s), { main: e, search: t, list: s };
          }
          moveContent() {
            'relative' !== this.settings.contentPosition &&
            'down' !== this.settings.openPosition
              ? 'up' !== this.settings.openPosition
                ? 'up' === this.putContent()
                  ? this.moveContentAbove()
                  : this.moveContentBelow()
                : this.moveContentAbove()
              : this.moveContentBelow();
          }
          searchDiv() {
            const e = document.createElement('div'),
              s = document.createElement('input'),
              i = document.createElement('div');
            e.classList.add(this.classes.search);
            const n = { main: e, input: s };
            if (
              (this.settings.showSearch ||
                (e.classList.add(this.classes.hide), (s.readOnly = !0)),
              (s.type = 'search'),
              (s.placeholder = this.settings.searchPlaceholder),
              (s.tabIndex = -1),
              s.setAttribute('aria-label', this.settings.searchPlaceholder),
              s.setAttribute('autocapitalize', 'off'),
              s.setAttribute('autocomplete', 'off'),
              s.setAttribute('autocorrect', 'off'),
              (s.oninput = t((e) => {
                this.callbacks.search(e.target.value);
              }, 100)),
              (s.onkeydown = (e) => {
                switch (e.key) {
                  case 'ArrowUp':
                  case 'ArrowDown':
                    return (
                      'ArrowDown' === e.key
                        ? this.highlight('down')
                        : this.highlight('up'),
                      !1
                    );
                  case 'Tab':
                    return this.callbacks.close(), !0;
                  case 'Escape':
                    return this.callbacks.close(), !1;
                  case 'Enter':
                  case ' ':
                    if (this.callbacks.addable && e.ctrlKey)
                      return i.click(), !1;
                    {
                      const e = this.content.list.querySelector(
                        '.' + this.classes.highlighted,
                      );
                      if (e) return e.click(), !1;
                    }
                    return !0;
                }
              }),
              e.appendChild(s),
              this.callbacks.addable)
            ) {
              i.classList.add(this.classes.addable);
              const t = document.createElementNS(
                'http://www.w3.org/2000/svg',
                'svg',
              );
              t.setAttribute('viewBox', '0 0 100 100');
              const s = document.createElementNS(
                'http://www.w3.org/2000/svg',
                'path',
              );
              s.setAttribute('d', this.classes.addablePath),
                t.appendChild(s),
                i.appendChild(t),
                (i.onclick = (e) => {
                  if (
                    (e.preventDefault(),
                    e.stopPropagation(),
                    !this.callbacks.addable)
                  )
                    return;
                  const t = this.content.search.input.value.trim();
                  if ('' === t) return void this.content.search.input.focus();
                  const s = (e) => {
                      let t = new a(e);
                      if (
                        (this.callbacks.addOption(t), this.settings.isMultiple)
                      ) {
                        let e = this.store.getSelected();
                        e.push(t.value), this.callbacks.setSelected(e, !0);
                      } else this.callbacks.setSelected([t.value], !0);
                      this.callbacks.search(''),
                        this.settings.closeOnSelect &&
                          setTimeout(() => {
                            this.callbacks.close();
                          }, 100);
                    },
                    i = this.callbacks.addable(t);
                  !1 !== i &&
                    null != i &&
                    (i instanceof Promise
                      ? i.then((e) => {
                          s('string' == typeof e ? { text: e, value: e } : e);
                        })
                      : s('string' == typeof i ? { text: i, value: i } : i));
                }),
                e.appendChild(i),
                (n.addable = { main: i, svg: t, path: s });
            }
            return n;
          }
          searchFocus() {
            this.content.search.input.focus();
          }
          getOptions(e = !1, t = !1, s = !1) {
            let i = '.' + this.classes.option;
            return (
              e && (i += ':not(.' + this.classes.placeholder + ')'),
              t && (i += ':not(.' + this.classes.disabled + ')'),
              s && (i += ':not(.' + this.classes.hide + ')'),
              Array.from(this.content.list.querySelectorAll(i))
            );
          }
          highlight(e) {
            const t = this.getOptions(!0, !0, !0);
            if (0 !== t.length)
              if (
                1 !== t.length ||
                t[0].classList.contains(this.classes.highlighted)
              ) {
                for (let s = 0; s < t.length; s++)
                  if (t[s].classList.contains(this.classes.highlighted)) {
                    const i = t[s];
                    i.classList.remove(this.classes.highlighted);
                    const n = i.parentElement;
                    if (n && n.classList.contains(this.classes.open)) {
                      const e = n.querySelector(
                        '.' + this.classes.optgroupLabel,
                      );
                      e && e.click();
                    }
                    let a =
                      t[
                        'down' === e
                          ? s + 1 < t.length
                            ? s + 1
                            : 0
                          : s - 1 >= 0
                          ? s - 1
                          : t.length - 1
                      ];
                    a.classList.add(this.classes.highlighted),
                      this.ensureElementInView(this.content.list, a);
                    const l = a.parentElement;
                    if (l && l.classList.contains(this.classes.close)) {
                      const e = l.querySelector(
                        '.' + this.classes.optgroupLabel,
                      );
                      e && e.click();
                    }
                    return;
                  }
                t['down' === e ? 0 : t.length - 1].classList.add(
                  this.classes.highlighted,
                ),
                  this.ensureElementInView(
                    this.content.list,
                    t['down' === e ? 0 : t.length - 1],
                  );
              } else t[0].classList.add(this.classes.highlighted);
          }
          listDiv() {
            const e = document.createElement('div');
            return e.classList.add(this.classes.list), e;
          }
          renderError(e) {
            this.content.list.innerHTML = '';
            const t = document.createElement('div');
            t.classList.add(this.classes.error),
              (t.textContent = e),
              this.content.list.appendChild(t);
          }
          renderSearching() {
            this.content.list.innerHTML = '';
            const e = document.createElement('div');
            e.classList.add(this.classes.searching),
              (e.textContent = this.settings.searchingText),
              this.content.list.appendChild(e);
          }
          renderOptions(e) {
            if (((this.content.list.innerHTML = ''), 0 === e.length)) {
              const e = document.createElement('div');
              return (
                e.classList.add(this.classes.search),
                (e.innerHTML = this.settings.searchText),
                void this.content.list.appendChild(e)
              );
            }
            for (const t of e) {
              if (t instanceof n) {
                const e = document.createElement('div');
                e.classList.add(this.classes.optgroup);
                const s = document.createElement('div');
                s.classList.add(this.classes.optgroupLabel), e.appendChild(s);
                const i = document.createElement('div');
                i.classList.add(this.classes.optgroupLabelText),
                  (i.textContent = t.label),
                  s.appendChild(i);
                const n = document.createElement('div');
                if (
                  (n.classList.add(this.classes.optgroupActions),
                  s.appendChild(n),
                  this.settings.isMultiple && t.selectAll)
                ) {
                  const e = document.createElement('div');
                  e.classList.add(this.classes.optgroupSelectAll);
                  let s = !0;
                  for (const e of t.options)
                    if (!e.selected) {
                      s = !1;
                      break;
                    }
                  s && e.classList.add(this.classes.selected);
                  const i = document.createElement('span');
                  (i.textContent = t.selectAllText), e.appendChild(i);
                  const a = document.createElementNS(
                    'http://www.w3.org/2000/svg',
                    'svg',
                  );
                  a.setAttribute('viewBox', '0 0 100 100'), e.appendChild(a);
                  const l = document.createElementNS(
                    'http://www.w3.org/2000/svg',
                    'path',
                  );
                  l.setAttribute('d', this.classes.optgroupSelectAllBox),
                    a.appendChild(l);
                  const o = document.createElementNS(
                    'http://www.w3.org/2000/svg',
                    'path',
                  );
                  o.setAttribute('d', this.classes.optgroupSelectAllCheck),
                    a.appendChild(o),
                    e.addEventListener('click', (e) => {
                      e.preventDefault(), e.stopPropagation();
                      const i = this.store.getSelected();
                      if (s) {
                        const e = i.filter((e) => {
                          for (const s of t.options)
                            if (e === s.value) return !1;
                          return !0;
                        });
                        this.callbacks.setSelected(e, !0);
                      } else {
                        const e = i.concat(t.options.map((e) => e.value));
                        for (const e of t.options)
                          this.store.getOptionByID(e.id) ||
                            this.callbacks.addOption(e);
                        this.callbacks.setSelected(e, !0);
                      }
                    }),
                    n.appendChild(e);
                }
                if ('off' !== t.closable) {
                  const i = document.createElement('div');
                  i.classList.add(this.classes.optgroupClosable);
                  const a = document.createElementNS(
                    'http://www.w3.org/2000/svg',
                    'svg',
                  );
                  a.setAttribute('viewBox', '0 0 100 100'),
                    a.classList.add(this.classes.arrow),
                    i.appendChild(a);
                  const l = document.createElementNS(
                    'http://www.w3.org/2000/svg',
                    'path',
                  );
                  a.appendChild(l),
                    t.options.some((e) => e.selected) ||
                    '' !== this.content.search.input.value.trim()
                      ? (i.classList.add(this.classes.open),
                        l.setAttribute('d', this.classes.arrowOpen))
                      : 'open' === t.closable
                      ? (e.classList.add(this.classes.open),
                        l.setAttribute('d', this.classes.arrowOpen))
                      : 'close' === t.closable &&
                        (e.classList.add(this.classes.close),
                        l.setAttribute('d', this.classes.arrowClose)),
                    s.addEventListener('click', (t) => {
                      t.preventDefault(),
                        t.stopPropagation(),
                        e.classList.contains(this.classes.close)
                          ? (e.classList.remove(this.classes.close),
                            e.classList.add(this.classes.open),
                            l.setAttribute('d', this.classes.arrowOpen))
                          : (e.classList.remove(this.classes.open),
                            e.classList.add(this.classes.close),
                            l.setAttribute('d', this.classes.arrowClose));
                    }),
                    n.appendChild(i);
                }
                e.appendChild(s);
                for (const s of t.options) e.appendChild(this.option(s));
                this.content.list.appendChild(e);
              }
              t instanceof a && this.content.list.appendChild(this.option(t));
            }
          }
          option(e) {
            if (e.placeholder) {
              const e = document.createElement('div');
              return (
                e.classList.add(this.classes.option),
                e.classList.add(this.classes.hide),
                e
              );
            }
            const t = document.createElement('div');
            return (
              (t.dataset.id = e.id),
              (t.id = e.id),
              t.classList.add(this.classes.option),
              t.setAttribute('role', 'option'),
              e.class &&
                e.class.split(' ').forEach((e) => {
                  t.classList.add(e);
                }),
              e.style && (t.style.cssText = e.style),
              this.settings.searchHighlight &&
              '' !== this.content.search.input.value.trim()
                ? (t.innerHTML = this.highlightText(
                    '' !== e.html ? e.html : e.text,
                    this.content.search.input.value,
                    this.classes.searchHighlighter,
                  ))
                : '' !== e.html
                ? (t.innerHTML = e.html)
                : (t.textContent = e.text),
              this.settings.showOptionTooltips &&
                t.textContent &&
                t.setAttribute('title', t.textContent),
              e.display || t.classList.add(this.classes.hide),
              e.disabled && t.classList.add(this.classes.disabled),
              e.selected &&
                this.settings.hideSelected &&
                t.classList.add(this.classes.hide),
              e.selected
                ? (t.classList.add(this.classes.selected),
                  t.setAttribute('aria-selected', 'true'),
                  this.main.main.setAttribute('aria-activedescendant', t.id))
                : (t.classList.remove(this.classes.selected),
                  t.setAttribute('aria-selected', 'false')),
              t.addEventListener('click', (t) => {
                t.preventDefault(), t.stopPropagation();
                const s = this.store.getSelected(),
                  i = t.currentTarget,
                  n = String(i.dataset.id);
                if (e.disabled || (e.selected && !this.settings.allowDeselect))
                  return;
                if (
                  (this.settings.isMultiple &&
                    this.settings.maxSelected <= s.length &&
                    !e.selected) ||
                  (this.settings.isMultiple &&
                    this.settings.minSelected >= s.length &&
                    e.selected)
                )
                  return;
                let a = !1;
                const l = this.store.getSelectedOptions();
                let o = [];
                this.settings.isMultiple &&
                  (o = e.selected ? l.filter((e) => e.id !== n) : l.concat(e)),
                  this.settings.isMultiple || (o = e.selected ? [] : [e]),
                  this.callbacks.beforeChange || (a = !0),
                  this.callbacks.beforeChange &&
                    (a = !1 !== this.callbacks.beforeChange(o, l)),
                  a &&
                    (this.store.getOptionByID(n) || this.callbacks.addOption(e),
                    this.callbacks.setSelected(
                      o.map((e) => e.value),
                      !1,
                    ),
                    this.settings.closeOnSelect && this.callbacks.close(),
                    this.callbacks.afterChange &&
                      this.callbacks.afterChange(o));
              }),
              t
            );
          }
          destroy() {
            this.main.main.remove(), this.content.main.remove();
          }
          highlightText(e, t, s) {
            let i = e;
            const n = new RegExp('(' + t.trim() + ')(?![^<]*>[^<>]*</)', 'i');
            if (!e.match(n)) return e;
            const a = e.match(n).index,
              l = a + e.match(n)[0].toString().length,
              o = e.substring(a, l);
            return (i = i.replace(n, `<mark class="${s}">${o}</mark>`)), i;
          }
          moveContentAbove() {
            const e = this.main.main.offsetHeight,
              t = this.content.main.offsetHeight;
            this.main.main.classList.remove(this.classes.openBelow),
              this.main.main.classList.add(this.classes.openAbove),
              this.content.main.classList.remove(this.classes.openBelow),
              this.content.main.classList.add(this.classes.openAbove);
            const s = this.main.main.getBoundingClientRect();
            (this.content.main.style.margin =
              '-' + (e + t - 1) + 'px 0px 0px 0px'),
              (this.content.main.style.top =
                s.top + s.height + window.scrollY + 'px'),
              (this.content.main.style.left = s.left + window.scrollX + 'px'),
              (this.content.main.style.width = s.width + 'px');
          }
          moveContentBelow() {
            this.main.main.classList.remove(this.classes.openAbove),
              this.main.main.classList.add(this.classes.openBelow),
              this.content.main.classList.remove(this.classes.openAbove),
              this.content.main.classList.add(this.classes.openBelow);
            const e = this.main.main.getBoundingClientRect();
            (this.content.main.style.margin = '-1px 0px 0px 0px'),
              'relative' !== this.settings.contentPosition &&
                ((this.content.main.style.top =
                  e.top + e.height + window.scrollY + 'px'),
                (this.content.main.style.left = e.left + window.scrollX + 'px'),
                (this.content.main.style.width = e.width + 'px'));
          }
          ensureElementInView(e, t) {
            const s = e.scrollTop + e.offsetTop,
              i = s + e.clientHeight,
              n = t.offsetTop,
              a = n + t.clientHeight;
            n < s ? (e.scrollTop -= s - n) : a > i && (e.scrollTop += a - i);
          }
          putContent() {
            const e = this.main.main.offsetHeight,
              t = this.main.main.getBoundingClientRect(),
              s = this.content.main.offsetHeight;
            return window.innerHeight - (t.top + e) <= s && t.top > s
              ? 'up'
              : 'down';
          }
          updateDeselectAll() {
            if (!this.store || !this.settings) return;
            const e = this.store.getSelectedOptions(),
              t = e && e.length > 0,
              s = this.settings.isMultiple,
              i = this.settings.allowDeselect,
              n = this.main.deselect.main,
              a = this.classes.hide;
            !i || (s && !t) ? n.classList.add(a) : n.classList.remove(a);
          }
        }
        class c {
          constructor(e) {
            (this.listen = !1),
              (this.observer = null),
              (this.select = e),
              this.select.addEventListener(
                'change',
                this.valueChange.bind(this),
                { passive: !0 },
              ),
              (this.observer = new MutationObserver(
                this.observeCall.bind(this),
              )),
              this.changeListen(!0);
          }
          enable() {
            this.select.disabled = !1;
          }
          disable() {
            this.select.disabled = !0;
          }
          hideUI() {
            (this.select.tabIndex = -1),
              (this.select.style.display = 'none'),
              this.select.setAttribute('aria-hidden', 'true');
          }
          showUI() {
            this.select.removeAttribute('tabindex'),
              (this.select.style.display = ''),
              this.select.removeAttribute('aria-hidden');
          }
          changeListen(e) {
            (this.listen = e),
              e &&
                this.observer &&
                this.observer.observe(this.select, {
                  subtree: !0,
                  childList: !0,
                  attributes: !0,
                }),
              e || (this.observer && this.observer.disconnect());
          }
          valueChange(e) {
            return (
              this.listen &&
                this.onValueChange &&
                this.onValueChange(this.getSelectedValues()),
              !0
            );
          }
          observeCall(e) {
            if (!this.listen) return;
            let t = !1,
              s = !1,
              i = !1;
            for (const n of e)
              n.target === this.select &&
                ('disabled' === n.attributeName && (s = !0),
                'class' === n.attributeName && (t = !0)),
                ('OPTGROUP' !== n.target.nodeName &&
                  'OPTION' !== n.target.nodeName) ||
                  (i = !0);
            t &&
              this.onClassChange &&
              this.onClassChange(this.select.className.split(' ')),
              s &&
                this.onDisabledChange &&
                (this.changeListen(!1),
                this.onDisabledChange(this.select.disabled),
                this.changeListen(!0)),
              i &&
                this.onOptionsChange &&
                (this.changeListen(!1),
                this.onOptionsChange(this.getData()),
                this.changeListen(!0));
          }
          getData() {
            let e = [];
            const t = this.select.childNodes;
            for (const s of t)
              'OPTGROUP' === s.nodeName && e.push(this.getDataFromOptgroup(s)),
                'OPTION' === s.nodeName && e.push(this.getDataFromOption(s));
            return e;
          }
          getDataFromOptgroup(e) {
            let t = {
              id: e.id,
              label: e.label,
              selectAll: !!e.dataset && 'true' === e.dataset.selectall,
              selectAllText: e.dataset ? e.dataset.selectalltext : 'Select all',
              closable: e.dataset ? e.dataset.closable : 'off',
              options: [],
            };
            const s = e.childNodes;
            for (const e of s)
              'OPTION' === e.nodeName &&
                t.options.push(this.getDataFromOption(e));
            return t;
          }
          getDataFromOption(e) {
            return {
              id: e.id,
              value: e.value,
              text: e.text,
              html: e.dataset && e.dataset.html ? e.dataset.html : '',
              selected: e.selected,
              display: 'none' !== e.style.display,
              disabled: e.disabled,
              mandatory: !!e.dataset && 'true' === e.dataset.mandatory,
              placeholder: 'true' === e.dataset.placeholder,
              class: e.className,
              style: e.style.cssText,
              data: e.dataset,
            };
          }
          getSelectedValues() {
            let e = [];
            const t = this.select.childNodes;
            for (const s of t) {
              if ('OPTGROUP' === s.nodeName) {
                const t = s.childNodes;
                for (const s of t)
                  if ('OPTION' === s.nodeName) {
                    const t = s;
                    t.selected && e.push(t.value);
                  }
              }
              if ('OPTION' === s.nodeName) {
                const t = s;
                t.selected && e.push(t.value);
              }
            }
            return e;
          }
          setSelected(e) {
            this.changeListen(!1);
            const t = this.select.childNodes;
            for (const s of t) {
              if ('OPTGROUP' === s.nodeName) {
                const t = s.childNodes;
                for (const s of t)
                  if ('OPTION' === s.nodeName) {
                    const t = s;
                    t.selected = e.includes(t.value);
                  }
              }
              if ('OPTION' === s.nodeName) {
                const t = s;
                t.selected = e.includes(t.value);
              }
            }
            this.changeListen(!0);
          }
          updateSelect(e, t, s) {
            this.changeListen(!1),
              e && (this.select.dataset.id = e),
              t && (this.select.style.cssText = t),
              s &&
                ((this.select.className = ''),
                s.forEach((e) => {
                  '' !== e.trim() && this.select.classList.add(e.trim());
                })),
              this.changeListen(!0);
          }
          updateOptions(e) {
            this.changeListen(!1), (this.select.innerHTML = '');
            for (const t of e)
              t instanceof n && this.select.appendChild(this.createOptgroup(t)),
                t instanceof a && this.select.appendChild(this.createOption(t));
            this.select.dispatchEvent(new Event('change')),
              this.changeListen(!0);
          }
          createOptgroup(e) {
            const t = document.createElement('optgroup');
            if (
              ((t.id = e.id),
              (t.label = e.label),
              e.selectAll && (t.dataset.selectAll = 'true'),
              'off' !== e.closable && (t.dataset.closable = e.closable),
              e.options)
            )
              for (const s of e.options) t.appendChild(this.createOption(s));
            return t;
          }
          createOption(e) {
            const t = document.createElement('option');
            return (
              (t.id = e.id),
              (t.value = e.value),
              (t.innerHTML = e.text),
              '' !== e.html && t.setAttribute('data-html', e.html),
              e.selected && (t.selected = e.selected),
              e.disabled && (t.disabled = !0),
              !1 === e.display && (t.style.display = 'none'),
              e.placeholder && t.setAttribute('data-placeholder', 'true'),
              e.mandatory && t.setAttribute('data-mandatory', 'true'),
              e.class &&
                e.class.split(' ').forEach((e) => {
                  t.classList.add(e);
                }),
              e.data &&
                'object' == typeof e.data &&
                Object.keys(e.data).forEach((s) => {
                  t.setAttribute(
                    'data-' +
                      (function (e) {
                        const t = e.replace(
                          /[A-Z\u00C0-\u00D6\u00D8-\u00DE]/g,
                          (e) => '-' + e.toLowerCase(),
                        );
                        return e[0] === e[0].toUpperCase() ? t.substring(1) : t;
                      })(s),
                    e.data[s],
                  );
                }),
              t
            );
          }
          destroy() {
            this.changeListen(!1),
              this.select.removeEventListener(
                'change',
                this.valueChange.bind(this),
              ),
              this.observer &&
                (this.observer.disconnect(), (this.observer = null)),
              delete this.select.dataset.id,
              this.showUI();
          }
        }
        return class {
          constructor(e) {
            var s;
            if (
              ((this.events = {
                search: void 0,
                searchFilter: (e, t) =>
                  -1 !== e.text.toLowerCase().indexOf(t.toLowerCase()),
                addable: void 0,
                beforeChange: void 0,
                afterChange: void 0,
                beforeOpen: void 0,
                afterOpen: void 0,
                beforeClose: void 0,
                afterClose: void 0,
              }),
              (this.windowResize = t(() => {
                (this.settings.isOpen || this.settings.isFullOpen) &&
                  this.render.moveContent();
              })),
              (this.windowScroll = t(() => {
                (this.settings.isOpen || this.settings.isFullOpen) &&
                  this.render.moveContent();
              })),
              (this.documentClick = (e) => {
                this.settings.isOpen &&
                  e.target &&
                  !(function (e, t) {
                    function s(e, s) {
                      return (s &&
                        e &&
                        e.classList &&
                        e.classList.contains(s)) ||
                        (s &&
                          e &&
                          e.dataset &&
                          e.dataset.id &&
                          e.dataset.id === t)
                        ? e
                        : null;
                    }
                    return (
                      s(e, t) ||
                      (function e(t, i) {
                        return t && t !== document
                          ? s(t, i)
                            ? t
                            : e(t.parentNode, i)
                          : null;
                      })(e, t)
                    );
                  })(e.target, this.settings.id) &&
                  this.close(e.type);
              }),
              (this.windowVisibilityChange = () => {
                document.hidden && this.close();
              }),
              (this.selectEl =
                'string' == typeof e.select
                  ? document.querySelector(e.select)
                  : e.select),
              !this.selectEl)
            )
              return void (
                e.events &&
                e.events.error &&
                e.events.error(new Error('Could not find select element'))
              );
            if ('SELECT' !== this.selectEl.tagName)
              return void (
                e.events &&
                e.events.error &&
                e.events.error(new Error('Element isnt of type select'))
              );
            this.selectEl.dataset.ssid && this.destroy(),
              (this.settings = new i(e.settings));
            const n = [
              'afterChange',
              'beforeOpen',
              'afterOpen',
              'beforeClose',
              'afterClose',
            ];
            for (const s in e.events)
              e.events.hasOwnProperty(s) &&
                (-1 !== n.indexOf(s)
                  ? (this.events[s] = t(e.events[s], 100))
                  : (this.events[s] = e.events[s]));
            (this.settings.disabled = (
              null === (s = e.settings) || void 0 === s ? void 0 : s.disabled
            )
              ? e.settings.disabled
              : this.selectEl.disabled),
              (this.settings.isMultiple = this.selectEl.multiple),
              (this.settings.style = this.selectEl.style.cssText),
              (this.settings.class = this.selectEl.className.split(' ')),
              (this.select = new c(this.selectEl)),
              this.select.updateSelect(
                this.settings.id,
                this.settings.style,
                this.settings.class,
              ),
              this.select.hideUI(),
              (this.select.onValueChange = (e) => {
                this.setSelected(e);
              }),
              (this.select.onClassChange = (e) => {
                (this.settings.class = e), this.render.updateClassStyles();
              }),
              (this.select.onDisabledChange = (e) => {
                e ? this.disable() : this.enable();
              }),
              (this.select.onOptionsChange = (e) => {
                this.setData(e);
              }),
              (this.store = new l(
                this.settings.isMultiple ? 'multiple' : 'single',
                e.data ? e.data : this.select.getData(),
              )),
              e.data && this.select.updateOptions(this.store.getData());
            const a = {
              open: this.open.bind(this),
              close: this.close.bind(this),
              addable: this.events.addable ? this.events.addable : void 0,
              setSelected: this.setSelected.bind(this),
              addOption: this.addOption.bind(this),
              search: this.search.bind(this),
              beforeChange: this.events.beforeChange,
              afterChange: this.events.afterChange,
            };
            (this.render = new o(this.settings, this.store, a)),
              this.render.renderValues(),
              this.render.renderOptions(this.store.getData());
            const h = this.selectEl.getAttribute('aria-label'),
              r = this.selectEl.getAttribute('aria-labelledby');
            h
              ? this.render.main.main.setAttribute('aria-label', h)
              : r && this.render.main.main.setAttribute('aria-labelledby', r),
              this.selectEl.parentNode &&
                this.selectEl.parentNode.insertBefore(
                  this.render.main.main,
                  this.selectEl.nextSibling,
                ),
              document.addEventListener('click', this.documentClick),
              window.addEventListener('resize', this.windowResize, !1),
              'auto' === this.settings.openPosition &&
                window.addEventListener('scroll', this.windowScroll, !1),
              document.addEventListener(
                'visibilitychange',
                this.windowVisibilityChange,
              ),
              this.settings.disabled && this.disable(),
              this.settings.alwaysOpen && this.open(),
              (this.selectEl.slim = this);
          }
          enable() {
            (this.settings.disabled = !1),
              this.select.enable(),
              this.render.enable();
          }
          disable() {
            (this.settings.disabled = !0),
              this.select.disable(),
              this.render.disable();
          }
          getData() {
            return this.store.getData();
          }
          setData(e) {
            const t = this.store.getSelected(),
              i = this.store.validateDataArray(e);
            if (i) return void (this.events.error && this.events.error(i));
            this.store.setData(e);
            const n = this.store.getData();
            this.select.updateOptions(n),
              this.render.renderValues(),
              this.render.renderOptions(n),
              this.events.afterChange &&
                !s(t, this.store.getSelected()) &&
                this.events.afterChange(this.store.getSelectedOptions());
          }
          getSelected() {
            return this.store.getSelected();
          }
          setSelected(e, t = !0) {
            const i = this.store.getSelected();
            this.store.setSelectedBy('value', Array.isArray(e) ? e : [e]);
            const n = this.store.getData();
            this.select.updateOptions(n),
              this.render.renderValues(),
              '' !== this.render.content.search.input.value
                ? this.search(this.render.content.search.input.value)
                : this.render.renderOptions(n),
              t &&
                this.events.afterChange &&
                !s(i, this.store.getSelected()) &&
                this.events.afterChange(this.store.getSelectedOptions());
          }
          addOption(e) {
            const t = this.store.getSelected();
            this.store.getDataOptions().some((t) => {
              var s;
              return (
                t.value ===
                (null !== (s = e.value) && void 0 !== s ? s : e.text)
              );
            }) || this.store.addOption(e);
            const i = this.store.getData();
            this.select.updateOptions(i),
              this.render.renderValues(),
              this.render.renderOptions(i),
              this.events.afterChange &&
                !s(t, this.store.getSelected()) &&
                this.events.afterChange(this.store.getSelectedOptions());
          }
          open() {
            this.settings.disabled ||
              this.settings.isOpen ||
              (this.events.beforeOpen && this.events.beforeOpen(),
              this.render.open(),
              this.settings.showSearch && this.render.searchFocus(),
              (this.settings.isOpen = !0),
              setTimeout(() => {
                this.events.afterOpen && this.events.afterOpen(),
                  this.settings.isOpen && (this.settings.isFullOpen = !0);
              }, this.settings.timeoutDelay),
              'absolute' === this.settings.contentPosition &&
                (this.settings.intervalMove &&
                  clearInterval(this.settings.intervalMove),
                (this.settings.intervalMove = setInterval(
                  this.render.moveContent.bind(this.render),
                  500,
                ))));
          }
          close(e = null) {
            this.settings.isOpen &&
              !this.settings.alwaysOpen &&
              (this.events.beforeClose && this.events.beforeClose(),
              this.render.close(),
              '' !== this.render.content.search.input.value && this.search(''),
              this.render.mainFocus(e),
              (this.settings.isOpen = !1),
              (this.settings.isFullOpen = !1),
              setTimeout(() => {
                this.events.afterClose && this.events.afterClose();
              }, this.settings.timeoutDelay),
              this.settings.intervalMove &&
                clearInterval(this.settings.intervalMove));
          }
          search(e) {
            if (
              (this.render.content.search.input.value !== e &&
                (this.render.content.search.input.value = e),
              !this.events.search)
            )
              return void this.render.renderOptions(
                '' === e
                  ? this.store.getData()
                  : this.store.search(e, this.events.searchFilter),
              );
            this.render.renderSearching();
            const t = this.events.search(e, this.store.getSelectedOptions());
            t instanceof Promise
              ? t
                  .then((e) => {
                    this.render.renderOptions(this.store.partialToFullData(e));
                  })
                  .catch((e) => {
                    this.render.renderError(
                      'string' == typeof e ? e : e.message,
                    );
                  })
              : Array.isArray(t)
              ? this.render.renderOptions(this.store.partialToFullData(t))
              : this.render.renderError(
                  'Search event must return a promise or an array of data',
                );
          }
          destroy() {
            document.removeEventListener('click', this.documentClick),
              window.removeEventListener('resize', this.windowResize, !1),
              'auto' === this.settings.openPosition &&
                window.removeEventListener('scroll', this.windowScroll, !1),
              document.removeEventListener(
                'visibilitychange',
                this.windowVisibilityChange,
              ),
              this.store.setData([]),
              this.render.destroy(),
              this.select.destroy();
          }
        };
      });
    </script>
    <script>
      let select;

      let selectedVendor;
      let selectedCountry;
      let searchPatterns;
      let parametersRange;
      let destinationCell;

      function validate() {
        let valid = !!(
          selectedVendor &&
          selectedCountry &&
          parametersRange &&
          destinationCell &&
          (!['westernbid', 'selleronline', 'skladusa'].includes(
            selectedVendor,
          ) ||
            (searchPatterns && searchPatterns.length))
        );

        console.log(
          selectedVendor,
          selectedCountry,
          searchPatterns,
          parametersRange,
          destinationCell,
          valid,
        );

        if (valid) {
          document.getElementById('submitButton').removeAttribute('disabled');
        } else {
          document.getElementById('submitButton').setAttribute('disabled', '');
        }
      }

      window.addEventListener('load', function () {
        select = new SlimSelect({
          select: '#columnSelect',

          events: {
            afterChange: (values) => {
              searchPatterns = values.map((val) => val.value);
              validate();
            },
          },
        });
      });

      function getSelectedRange() {
        google.script.run
          .withSuccessHandler(function (activeRange) {
            const element = document.getElementById('parametersRange');
            element.value = activeRange;
            element.dispatchEvent(new Event('change', { bubbles: true }));
          })
          .getSelectedRange();

        return false;
      }

      function getSelectedCell() {
        google.script.run
          .withSuccessHandler(function (activeRange) {
            const element = document.getElementById('destinationCell');
            element.value = activeRange;
            element.dispatchEvent(new Event('change', { bubbles: true }));
          })
          .getSelectedCell();

        return false;
      }

      function onFormChange(form) {
        const formData = new FormData(form);

        if (
          ['westernbid', 'selleronline', 'skladusa'].includes(
            formData.get('vendor'),
          ) &&
          formData.get('country')
        ) {
          if (
            selectedVendor !== formData.get('vendor') ||
            selectedCountry !== formData.get('country')
          ) {
            select.disable();

            google.script.run
              .withSuccessHandler(function (rates) {
                select.setData(
                  rates.map(([key, value]) => ({ text: key, value: key })),
                );

                select.enable();
                document
                  .getElementById('columnSelectRow')
                  .classList.remove('d-none');
              })
              .parse(
                formData.get('vendor'),
                formData.get('country'),
                10,
                10,
                12,
                100,
              );
          }
        } else {
          select.setData([]);
          document.getElementById('columnSelectRow').classList.add('d-none');
        }

        selectedVendor = formData.get('vendor');
        selectedCountry = formData.get('country');
        parametersRange = formData.get('parameters');
        destinationCell = formData.get('destination');

        validate();
      }

      function run() {
        console.log('submit');
        google.script.run
          .withSuccessHandler(function (rates) {
            console.log(rates);
          })
          .parseByReference(
            selectedVendor,
            selectedCountry,
            parametersRange,
            destinationCell,
            searchPatterns,
          );

        return false;
      }

      function formSubmit(form) {
        console.log(form);
        console.log(new FormData(form));
        form.reset()
        return false
      }
    </script>
  </head>
  <body>
    <form id="parsing" onchange="onFormChange(this)" onsubmit='return formSubmit(this)'>
      <div class="block w-75 center">
        <div class="row">
          <div class="inline form-group w-100">
            <label for="parametersRange">Parameters range</label>
            <input
              type="text"
              id="parametersRange"
              class="w-100"
              value="<?= getSelectedRange() ?>"
              name="parameters"
              pattern="^[A-Z]+[1-9]+:[A-Z]+[1-9]+$"
            />
            <span class="error">Invalid range</span>
          </div>
          <div class="inline form-group">
            <button onclick="return getSelectedRange()">Active range</button>
          </div>
        </div>
        <div class="row">
          <div class="inline form-group w-100">
            <label for="vendor">Vendor</label>
            <select id="vendor" class="w-100" name="vendor">
              <option selected value="novaglobal">Nova Poshta Global</option>
              <option value="dhlexpress">DHL Express</option>
              <option value="westernbid">Western Bid</option>
              <option value="skladusa">Sklad USA</option>
              <option value="selleronline">Seller Online</option>
            </select>
          </div>
          <div class="inline form-group w-100">
            <label for="country">Country</label>
            <select id="country" class="w-100" name="country">
              <option selected value="USA">USA</option>
              <option value="Canada">Canada</option>
              <option value="Australia">Australia</option>
              <option value="New Zealand">New Zealand</option>
              <option value="UK">United Kingdom</option>
              <option value="Germany">Germany</option>
              <option value="France">France</option>
              <option value="Italy">Italy</option>
              <option value="Netherlands">Netherlands</option>
              <option value="Spain">Spain</option>
            </select>
          </div>
        </div>
        <div class="row d-none" id="columnSelectRow">
          <div class="inline form-group w-100">
            <label for="columnSelect">Columns</label>
            <select id="columnSelect" multiple name="searchPatterns[]">
              <option>Option 1</option>
              <option>Option 2</option>
              <option>Option 3</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div class="inline form-group w-100">
            <label for="destinationCell">Destination</label>
            <input
              type="text"
              id="destinationCell"
              class="w-100"
              pattern="^[A-Z]+[1-9]+$"
              name="destination"
            />
            <span class="error">Invalid cell address</span>
          </div>
          <div class="inline form-group">
            <button onclick="return getSelectedCell()">Active cell</button>
          </div>
        </div>
        <div class="row">
          <div class="inline form-group w-100">
            <button
              class="action w-third"
              disabled
              id="submitButton"
              onclick="return run()"
            >
              Parse
            </button>
          </div>
        </div>
      </div>
    </form>
  </body>
</html>
